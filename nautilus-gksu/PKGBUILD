# Maintainer: Jove Yu <yushijun110 [AT] gmail.com >

pkgname=nautilus-gksu
_pkgname=gksu
pkgver=2.0.2
pkgrel=1
pkgdesc="privilege granting extension for nautilus using gksu
 The gksu extension for nautilus allows you to open files with
 administration privileges using the context menu when browsing your
 files with nautilus."
arch=('i686' 'x86_64')
url="http://www.nongnu.org/gksu/index.html"
license=('GPL')
depends=('libgksu>=2.0.12' 'xorg-xauth')
makedepends=('gtk-doc' 'intltool')
options=('!libtool')

build() {
  cd "${srcdir}/${_pkgname}-${pkgver}"
  sed -i -e 's|/usr/bin/x-terminal-emulator|-l gnome-terminal|g' gksu.desktop
  echo "TryExec=gnome-terminal" >> gksu.desktop

  cd "${srcdir}/${_pkgname}-${pkgver}/nautilus-gksu"
  sed -i 's_#include <glib/gkeyfile.h>$_ _' *.c
   
  cd "${srcdir}/${_pkgname}-${pkgver}"
  ./configure --prefix=/usr \
    --sysconfdir=/etc \
    --localstatedir=/var \
    --disable-static 
  make
}

package() {
  cd "${srcdir}/${_pkgname}-${pkgver}"
  make DESTDIR="${pkgdir}" install
  rm -r "${pkgdir}/usr/bin/"
  rm -r "${pkgdir}/usr/share/"
  mkdir "${pkgdir}/usr/lib/nautilus/extensions-3.0/"
  cp "${pkgdir}/usr/lib/nautilus/extensions-2.0/libnautilus-gksu.so" "${pkgdir}/usr/lib/nautilus/extensions-3.0/"
  
}
